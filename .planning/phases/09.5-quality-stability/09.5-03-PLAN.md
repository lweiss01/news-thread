---
id: "09.5-03"
name: "UI Consistency & Fixes"
wave: "1"
depends_on: ["09.5-02"]
files_snapshot:
  - "app/src/main/java/com/newsthread/app/presentation/common/ArticleCard.kt"
  - "app/src/main/java/com/newsthread/app/presentation/feed/FeedViewModel.kt"
  - "app/src/main/java/com/newsthread/app/presentation/comparison/ComparisonViewModel.kt"
  - "app/src/main/java/com/newsthread/app/presentation/comparison/ReliabilityBadge.kt"

tasks:
  - id: ui_shield_badges
    name: "Standardize Shield Badges"
    description: |
      Replace `SourceBadge` (stars) with `ReliabilityBadge` (shields) in `ArticleCard`.
      This ensures consistency between the Feed and Compare Perspectives screens.
      (Delete `SourceBadge` or keep it deprecated if used elsewhere).

  - id: ui_unbookmark
    name: "Implement Unbookmark Action"
    description: |
      1.  Update `FeedViewModel` to observe `TrackingRepository.getTrackedStories()` and map it to a `Set<String>` of tracked URLs.
      2.  Expose `trackedArticleUrls` to the UI.
      3.  Update `FeedScreen` to pass this state to `ArticleCard`.
      4.  Update `ArticleCard` to show a clickable Bookmark icon (Filled/Outlined) based on state.
      5.  Implement `toggleFollow(article)` in ViewModel (Follow if not tracked, Unfollow if tracked).

  - id: fix_duplicate_sources
    name: "Fix Duplicate/Missing Ratings in Compare"
    description: |
      The user reported "ABC News" appearing twice with different ratings.
      This is likely due to inconsistent source mapping (ID vs Name vs Domain) in `ComparisonViewModel` / `MatchedArticleCard`.
      Apply the same robust mapping logic from `FeedViewModel` (ID + Domain + Name) to `ComparisonScreen`'s rating lookup.
